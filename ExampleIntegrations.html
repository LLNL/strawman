

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Example Integrations &mdash; Strawman 0.1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Strawman 0.1.0 documentation" href="index.html"/>
        <link rel="up" title="Strawman Documentation" href="Strawman.html"/>
        <link rel="next" title="Building Strawman" href="BuildingStrawman.html"/>
        <link rel="prev" title="Strawman Overview" href="Overview.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Strawman
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="Strawman.html">Strawman Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Overview.html">Strawman Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Example Integrations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lulesh">Lulesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#running-lulesh">Running Lulesh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cloverleaf3d">CloverLeaf3D</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#running-cloverleaf3d">Running CloverLeaf3D</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kripke">Kripke</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#running-kripke">Running Kripke</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="BuildingStrawman.html">Building Strawman</a></li>
<li class="toctree-l2"><a class="reference internal" href="StrawmanAPI.html">Strawman API</a></li>
<li class="toctree-l2"><a class="reference internal" href="Actions/index.html">Strawman Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="GPU_notes.html">Strawman GPU Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="Publications.html">Publications and Presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Licenses.html">License Info</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Strawman</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="Strawman.html">Strawman Documentation</a> &raquo;</li>
      
    <li>Example Integrations</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/ExampleIntegrations.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="example-integrations">
<h1>Example Integrations<a class="headerlink" href="#example-integrations" title="Permalink to this headline">¶</a></h1>
<p>Strawman comes with three example integrations:</p>
<blockquote>
<div><ul class="simple">
<li>Lulesh: a lagrangian shock hydrodynamics code</li>
<li>Kripke: a deterministic neutron transport code</li>
<li>CloverLeaf3D: an eulerian hydrodynamics code</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All three example codes use both MPI and OpenMP for hybrid parallelism.</p>
</div>
<div class="section" id="lulesh">
<h2>Lulesh<a class="headerlink" href="#lulesh" title="Permalink to this headline">¶</a></h2>
<p>Lulesh is a proxy-application for LLNL&#8217;s production ALE3D code.
Lulesh in programmed in C++ and uses an unstructured mesh.
More information about Lulesh can be found at <a class="reference external" href="https://codesign.llnl.gov/lulesh.php">https://codesign.llnl.gov/lulesh.php</a>.</p>
<p>The Strawman integration can be found in two locations.
Lulesh&#8217;s mesh description can be found at line 189 in <code class="docutils literal"><span class="pre">/src/examples/proxies/lulesh2.0.3/lulesh-init.cc</span></code>, and the Strawman API usage can be found in the simulations main loop beginning at line 2769 in the file <code class="docutils literal"><span class="pre">/src/examples/proxies/lulesh2.0.3/lulesh.cc</span></code>.</p>
<div class="section" id="running-lulesh">
<h3>Running Lulesh<a class="headerlink" href="#running-lulesh" title="Permalink to this headline">¶</a></h3>
<p>Strawman will create two versions of lulesh, one serial and one MPI parallel, but both versions are capable of using OpenMP.
Lulesh takes several command line arguments, but the most useful are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">-p</span></code> prints the progress of the solver as the simulation progresses</li>
<li><code class="docutils literal"><span class="pre">-i</span> <span class="pre">{number</span> <span class="pre">of</span> <span class="pre">iterations}</span></code> how many iterations to run the simulation. Note: this is not a guarantee, since Lulesh has other termination criteria.</li>
<li><code class="docutils literal"><span class="pre">-s</span> <span class="pre">{per</span> <span class="pre">node</span> <span class="pre">problem</span> <span class="pre">size}</span></code> defines the problem size to run on each node. The larger the value, the longer the times steps will be take to calculate</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When running lulesh in parallel, the number of MPI processes must be a perfect cube. For example, some valid numbers of MPI tasks would be 1, 2, 8, and 27.</p>
</div>
<p>The command below would launch Lulesh for 10 iterations with a problem size of 32^3 zones per node (8*32^3 = 262,144 total zones):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>srun -n <span class="m">8</span> lulesh_par -i <span class="m">10</span> -s 32
</pre></div>
</div>
</div>
</div>
<div class="section" id="cloverleaf3d">
<h2>CloverLeaf3D<a class="headerlink" href="#cloverleaf3d" title="Permalink to this headline">¶</a></h2>
<p>CloverLeaf3D is a proxy-application from the Atomic Weapons Establishment (AWE) that can be found at <a class="reference external" href="http://uk-mac.github.io/CloverLeaf3D">http://uk-mac.github.io/CloverLeaf3D</a>.
CloverLeaf is written in Fortran90.
The data integration can be found in the file <code class="docutils literal"><span class="pre">src/examples/proxies/cloverleaf3d-ref/visit.F90</span></code>, and the Strawman API in the main loop can be found at <code class="docutils literal"><span class="pre">src/examples/proxies/cloverleaf3d-ref/hydro.F90</span></code> starting at line 46.
CloverLeaf3D uses ghost zones, thus they have to be stripped each time step before being passed to Strawman.</p>
<div class="section" id="running-cloverleaf3d">
<h3>Running CloverLeaf3D<a class="headerlink" href="#running-cloverleaf3d" title="Permalink to this headline">¶</a></h3>
<p>Unlike the other two example integrations, CloverLeaf3D uses an input deck to describe the problem setup.
There are a number of example problems in the CloverLeaf3D source directory, and one (<cite>clover.in</cite>) is copied into the build directory.</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>*clover
state 1 density=0.2 energy=1.0
state 2 density=1.0 energy=2.5 geometry=cuboid xmin=0.0 xmax=5.0 ymin=0.0 ymax=2.0 zmin=0.0 zmax=2.0
x_cells=10
y_cells=2
z_cells=2
xmin=0.0
ymin=0.0
zmin=0.0
xmax=10.0
ymax=2.0
zmax=2.0
initial_timestep=0.04
max_timestep=0.04
end_step=75
test_problem 1

visit_frequency=10
*endclover
</pre></div>
</div>
<p>Important variables to keep note of are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">state</span></code> defines different areas with in the mesh, their shape, and the amount of initial energy deposited in them.</li>
<li><code class="docutils literal"><span class="pre">x_cells</span></code> defines the number of cells in the x direction</li>
<li><code class="docutils literal"><span class="pre">xmin</span></code> and <code class="docutils literal"><span class="pre">xmax</span></code> defines the spatial extents in the x direction for the problem</li>
<li><code class="docutils literal"><span class="pre">visit_freqency</span></code> defines often the Strawman API is called</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="kripke">
<h2>Kripke<a class="headerlink" href="#kripke" title="Permalink to this headline">¶</a></h2>
<p>Kripke is a scalable deterministic neutron transport solver that has an embedded test problem.
More information about Kripke can be found at <a class="reference external" href="https://codesign.llnl.gov/kripke.php">https://codesign.llnl.gov/kripke.php</a>.
Unlike the other two proxy-applications, Kripke does not have discrete time steps.
Instead, the simulation represents a single moment in time and the iterations converge to a solution for the problem.</p>
<p>The both the Strawman API calls and the data integration can be found in <code class="docutils literal"><span class="pre">src/examples/proxies/kripke/Kripke/Sweep_Solver.cpp</span></code>.
Kripke is meant to study the efficiency of different loop orderings and memory layouts for different architectures which makes zero copying the data difficult.
Thus, the data is extracted each iteration.
Mesh data extraction can be found starting at line 20, and the API calls can be found at line 101.</p>
<div class="section" id="running-kripke">
<h3>Running Kripke<a class="headerlink" href="#running-kripke" title="Permalink to this headline">¶</a></h3>
<p>Kripke take many command line parameters, and there is an example script that is copied into the directory where Kripke is built.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>srun -n <span class="m">8</span> kripke_par --procs 2,2,2 --zones 32,32,32 --niter <span class="m">5</span> --dir 1:2 --grp 1:1 --legendre <span class="m">4</span> --quad 4:4
</pre></div>
</div>
<p>The parameters that control the problem size and layout are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">--procs</span></code> controls the layout of the MPI processes over the mesh. In the example, we launch 8 total MPI tasks and distribute them evenly in each coordinate direction. The cross product of this argument must equal the number of MPI tasks, e.g. 2x2x2 = 8. Another valid value for 8 MPI tasks is <code class="docutils literal"><span class="pre">1,1,8</span></code>.</li>
<li><code class="docutils literal"><span class="pre">--zones</span></code> controls the number of zones in each coordinate direction of the problem mesh. In this case, the total mesh size is 32^3, and the number of zones for each MPI task will be 16^3. This is simple zones / procs, e.g. 32/2, 32/2, 32/2.</li>
<li><code class="docutils literal"><span class="pre">--niter</span></code> controls the number of iterations. Note: as the solver converges on a solution, the images will differ less and less.</li>
</ul>
</div></blockquote>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="BuildingStrawman.html" class="btn btn-neutral float-right" title="Building Strawman" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Overview.html" class="btn btn-neutral" title="Strawman Overview" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2016, LLNS.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>